(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{4055:function(e,n,t){"use strict";t.r(n);var r=t(76687),o=t(59499),a=t(50029),c=t(87794),i=t.n(c),s=t(9008),l=t(67294),u=t(9473),d=t(76509),f=t(3283),m=t.n(f),h=t(85893);function x(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?x(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function v(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return g(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==t.return||t.return()}finally{if(i)throw a}}}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}n.default=function(){var e=(0,u.v9)((function(e){return e.blockchain})),n=(0,l.useState)([]),t=n[0],c=n[1],f=(0,l.useState)([]),x=f[0],g=f[1],b=(0,l.useState)([]),y=b[0],w=b[1],j=(0,l.useState)([]),C=j[0],k=j[1],N=(0,l.useState)({}),O=N[0],S=N[1],I=(0,l.useState)([]),A=I[0],Z=I[1],D=(0,l.useState)([]),_=D[0],E=D[1],M=(0,l.useState)({}),T=M[0],F=M[1],P=(0,l.useState)(),R=P[0],U=P[1],q=(0,l.useState)(0),W=q[0],B=q[1],L=(0,l.useState)(0),X=L[0],G=L[1],H=(0,l.useState)(),K=H[0],V=H[1];(0,l.useEffect)((function(){c([]),e.minerContract&&e.account&&$()}),[e.minerContract,e.account]),(0,l.useEffect)((function(){w([]),e.mineContract&&e.account&&z(),Z([]),e.mineContract&&e.account&&J()}),[e.mineContract,e.account]),(0,l.useEffect)((function(){Y()}),[e.diamondContract,e.account]);var Y=function(){var n=(0,a.Z)(i().mark((function n(){var t,r,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=0,null===(t=e.diamondContract)||void 0===t||!t.methods||!e.account){n.next=5;break}return n.next=4,null===(o=e.diamondContract)||void 0===o?void 0:o.methods.balanceOf(e.account).call();case 4:r=n.sent;case 5:B(parseFloat(m().utils.fromWei(m().utils.toBN(r))));case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),$=function(){var n=(0,a.Z)(i().mark((function n(){var t,r,o,a,s,l,u,d;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],null===(t=e.minerContract)||void 0===t||!t.methods||!e.account){n.next=10;break}return n.next=4,null===(o=e.minerContract)||void 0===o?void 0:o.methods.balanceOf(e.account).call();case 4:if(0===(a=n.sent)){n.next=10;break}return n.next=8,e.minerContract.methods.batchedMinerOfOwner(e.account,0,a).call();case 8:if(s=n.sent){l=v(s);try{for(l.s();!(u=l.n()).done;)d=u.value,r.push(parseInt(d.tokenId))}catch(i){l.e(i)}finally{l.f()}r.sort((function(e,n){return e-n}))}case 10:c(r);case 11:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),z=function(){var n=(0,a.Z)(i().mark((function n(){var t,r,a,c,s,l,u,d,f,h;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],clearTimeout(K),null===(t=e.mineContract)||void 0===t||!t.methods||!e.account){n.next=18;break}return n.next=5,null===(a=e.mineContract)||void 0===a?void 0:a.methods.ownedStakesBalance(e.account).call();case 5:if(0===(c=n.sent)){n.next=18;break}return n.next=9,e.mineContract.methods.batchedStakesOfOwner(e.account,0,c).call();case 9:if(!(s=n.sent)){n.next=18;break}u=v(s);try{for(u.s();!(d=u.n()).done;)f=d.value,r.push(parseInt(f.tokenId))}catch(i){u.e(i)}finally{u.f()}return n.next=15,null===(l=e.mineContract)||void 0===l?void 0:l.methods.YIELD_CPS().call();case 15:h=n.sent,V(setInterval((function(){var e,n=parseFloat(m().utils.fromWei("0","ether")),t=v(s);try{var r=function(){var t=e.value,r=parseFloat(m().utils.fromWei(m().utils.toBN(Math.round(Date.now()-Math.round(1e3*t.startTimestamp))*("0"===t.level?1:5)*parseFloat(h)/1e3),"ether"));S((function(e){return p(p({},e),{},(0,o.Z)({},t.tokenId,p(p({},e[t.tokenId]),{},{earned:r})))})),n+=r};for(t.s();!(e=t.n()).done;)r()}catch(i){t.e(i)}finally{t.f()}G(n)}),100)),r.sort((function(e,n){return e-n}));case 18:w(r);case 19:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),J=function(){var n=(0,a.Z)(i().mark((function n(){var t,r,a,c,s,l,u,d,f,m;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],clearTimeout(R),null===(t=e.mineContract)||void 0===t||!t.methods||!e.account){n.next=14;break}return n.next=5,null===(a=e.mineContract)||void 0===a?void 0:a.methods.ownedCooldownsBalance(e.account).call();case 5:if(0===(c=n.sent)){n.next=14;break}return n.next=9,e.mineContract.methods.batchedCooldownsOfOwner(e.account,0,c).call();case 9:return l=n.sent,n.next=12,null===(s=e.mineContract)||void 0===s?void 0:s.methods.UNSTAKE_COOLDOWN_DURATION().call();case 12:if(u=n.sent,l){d=v(l);try{for(d.s();!(f=d.n()).done;)m=f.value,r.push(parseInt(m.tokenId))}catch(i){d.e(i)}finally{d.f()}U(setInterval((function(){var e,n=v(l);try{var t=function(){var n=e.value,t=new Date(1e3*(parseInt(n.startTimestamp)+parseInt(u))).getTime()-(new Date).getTime(),r={h:Math.floor(t/1e3/60/60),m:Math.floor(t%36e5/6e4),s:Math.floor(t%6e4/1e3)};F((function(e){return p(p({},e),{},(0,o.Z)({},n.tokenId,p(p({},e[n.tokenId]),{},{timeDiff:t,timeRemaining:r,withdraw:!(t>0)})))}))};for(n.s();!(e=n.n()).done;)t()}catch(i){n.e(i)}finally{n.f()}}),1e3))}case 14:Z(r);case 15:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),Q=function(){var n=(0,a.Z)(i().mark((function n(){var t,r,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:null!==(t=e.diamondContract)&&void 0!==t&&t.methods&&null!==(r=e.mineContract)&&void 0!==r&&r.methods&&e.account&&(null===(o=e.mineContract)||void 0===o||o.methods.claimDiamondsAndMaybeUnstake(y,!1).send({to:d.q7.mine,from:e.account,value:0}).once("sending",(function(e){console.log(e)})).once("sent",(function(e){console.log(e)})).once("transactionHash",(function(e){console.log(e)})).once("receipt",(function(e){z(),Y()})).on("error",(function(e){console.log(e)})).then((function(e){console.log(e)})).catch((function(e){console.log(e)})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ee=function(){var n=(0,a.Z)(i().mark((function n(){var t,r,o,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(t=e.mineContract)||void 0===t||!t.methods||!e.account){n.next=5;break}return n.next=3,null===(r=e.minerContract)||void 0===r?void 0:r.methods.isApprovedForAll(e.account,d.q7.mine).call();case 3:n.sent?null===(o=e.mineContract)||void 0===o||o.methods.stakeMany(x).send({to:d.q7.mine,from:e.account,value:0}).once("receipt",(function(e){z(),$()})).catch((function(e){console.log(e)})):null===(a=e.minerContract)||void 0===a||a.methods.setApprovalForAll(d.q7.mine,!0).send({to:d.q7.mine,from:e.account,value:0}).then((function(){var n;null===(n=e.mineContract)||void 0===n||n.methods.stakeMany(x).send({to:d.q7.mine,from:e.account,value:0}).once("receipt",(function(e){z(),$()})).catch((function(e){console.log(e)}))}));case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ne=function(){var n=(0,a.Z)(i().mark((function n(){var t,r,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:null!==(t=e.diamondContract)&&void 0!==t&&t.methods&&null!==(r=e.mineContract)&&void 0!==r&&r.methods&&e.account&&(null===(o=e.mineContract)||void 0===o||o.methods.claimDiamondsAndMaybeUnstake(C,!0).send({to:d.q7.mine,from:e.account,value:0}).once("receipt",(function(e){z(),J()})).catch((function(e){console.log(e)})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),te=function(){var n=(0,a.Z)(i().mark((function n(){var t,r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:null!==(t=e.mineContract)&&void 0!==t&&t.methods&&e.account&&(null===(r=e.mineContract)||void 0===r||r.methods.withdrawMiner(_).send({to:d.q7.mine,from:e.account,value:0}).once("receipt",(function(e){$(),J()})).catch((function(e){console.log(e)})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(s.default,{children:(0,h.jsx)("title",{children:"Game | MinerVerse"})}),d.e1.whitelistOnly&&(d.e1.whitelistedWallets.find((function(n){var t;return n.toLowerCase()===(null===(t=e.account)||void 0===t?void 0:t.toLowerCase())||""}))?(0,h.jsx)("section",{className:"text-gray-900 bg-gray-900 body-font h-full",children:(0,h.jsxs)("div",{className:"flex flex-col justify-center items-center space-y-5 overflow-auto pt-44 pb-11",children:[(0,h.jsx)("div",{className:"px-11 text-center w-full",children:(0,h.jsxs)("div",{className:"text-xl text-center flex flex-col items-center bg-gray-700 text-white shadow-lg p-6 rounded-lg",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-5",children:[(0,h.jsxs)("h5",{className:"flex flex-col items-start",children:[(0,h.jsx)("span",{children:"Total Diamonds: "}),(0,h.jsx)("span",{children:"Earned Diamonds: "})]}),(0,h.jsxs)("h5",{className:"flex flex-col items-start",children:[(0,h.jsx)("span",{children:W.toFixed(5)}),(0,h.jsx)("span",{children:X.toFixed(5)})]})]}),(0,h.jsx)("button",{disabled:0===X,onClick:Q,className:"mt-4 py-1 px-3 bg-rose-500 disabled:hover:bg-rose-500 hover:bg-rose-600 rounded-md",children:"Claim"})]})}),(0,h.jsxs)("div",{className:"px-11 text-center w-full",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between w-full mb-4 p-2 px-3 bg-gray-700 text-white rounded-lg shadow-lg",children:[(0,h.jsx)("h3",{className:"font-bold text-xl",children:"Staked"}),(0,h.jsxs)("div",{className:"flex space-x-3",children:[(0,h.jsx)("button",{onClick:function(){k([])},className:"py-1 px-3 bg-gray-400 hover:bg-gray-500 rounded-md",children:"Unselect"}),(0,h.jsx)("button",{onClick:function(){k((0,r.Z)(y))},className:"py-1 px-3 bg-gray-400 hover:bg-gray-500 rounded-md",children:"Select All"}),(0,h.jsx)("button",{disabled:0===C.length,onClick:ne,className:"py-1 px-3 bg-rose-500 disabled:hover:bg-rose-500 hover:bg-rose-600 rounded-md",children:"Unstake"})]})]}),(0,h.jsx)("div",{className:"flex flex-wrap justify-center",children:y.map((function(e){var n;return(0,h.jsx)("div",{onClick:function(){var n=C.indexOf(e);k(n>-1?C.filter((function(n){return n!==e})):[].concat((0,r.Z)(C),[e]))},className:"relative text-white shadow-lg p-4 mr-1 mb-1 w-[100px] cursor-pointer "+(-1!==C.indexOf(e)?" bg-gray-500":"bg-gray-700"),children:(0,h.jsxs)("div",{className:"flex flex-col items-center",children:[(0,h.jsx)("p",{className:"text-lg",children:e}),(null===(n=O[e])||void 0===n?void 0:n.earned)&&(0,h.jsx)("p",{className:"text-sm text-gray-300",children:O[e].earned.toFixed(3)})]})},e)}))})]}),(0,h.jsxs)("div",{className:"px-11 text-center w-full",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between w-full mb-4 p-2 px-3 bg-gray-700 text-white rounded-lg shadow-lg",children:[(0,h.jsx)("h3",{className:"font-bold text-xl",children:"Not Staked"}),(0,h.jsxs)("div",{className:"flex space-x-3",children:[(0,h.jsx)("button",{onClick:function(){g([])},className:"py-1 px-3 bg-gray-400 hover:bg-gray-500 rounded-md",children:"Unselect"}),(0,h.jsx)("button",{onClick:function(){g((0,r.Z)(t))},className:"py-1 px-3 bg-gray-400 hover:bg-gray-500 rounded-md",children:"Select All"}),(0,h.jsx)("button",{disabled:0===x.length,onClick:ee,className:"py-1 px-3 bg-rose-500 disabled:hover:bg-rose-500 hover:bg-rose-600 rounded-md",children:"Stake"})]})]}),(0,h.jsx)("div",{className:"flex flex-wrap justify-center",children:t.map((function(e){return(0,h.jsx)("div",{onClick:function(){var n=x.indexOf(e);g(n>-1?x.filter((function(n){return n!==e})):[].concat((0,r.Z)(x),[e]))},className:"relative text-white shadow-lg p-4 mr-1 mb-1 w-[100px] cursor-pointer "+(-1!==x.indexOf(e)?" bg-gray-500":"bg-gray-700"),children:(0,h.jsx)("p",{className:"",children:e})},e)}))})]})," ",(0,h.jsxs)("div",{className:"px-11 text-center w-full",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between w-full mb-4 p-2 px-3 bg-gray-700 text-white rounded-lg shadow-lg",children:[(0,h.jsx)("h3",{className:"font-bold text-xl",children:"Cooldown"}),(0,h.jsxs)("div",{className:"flex space-x-3",children:[(0,h.jsx)("button",{onClick:function(){E([])},className:"py-1 px-3 bg-gray-400 hover:bg-gray-500 rounded-md",children:"Unselect"}),(0,h.jsx)("button",{onClick:function(){E((0,r.Z)(A))},className:"py-1 px-3 bg-gray-400 hover:bg-gray-500 rounded-md",children:"Select All"}),(0,h.jsx)("button",{disabled:0===_.length,onClick:te,className:"py-1 px-3 bg-rose-500 disabled:hover:bg-rose-500 hover:bg-rose-600 rounded-md",children:"Withdraw"})]})]}),(0,h.jsx)("div",{className:"flex flex-wrap justify-center",children:A.map((function(e){var n,t;return(0,h.jsxs)("div",{onClick:function(){var n;if(null!==(n=T[e])&&void 0!==n&&n.withdraw){var t=_.indexOf(e);E(t>-1?_.filter((function(n){return n!==e})):[].concat((0,r.Z)(_),[e]))}},className:"relative text-white shadow-lg p-4 mr-1 mb-1 w-[120px] cursor-pointer "+(-1!==_.indexOf(e)?" bg-gray-500":"bg-gray-700"),children:[(0,h.jsx)("p",{className:"text-lg",children:e}),null===(n=T[e])||void 0===n||!n.timeRemaining||null!==(t=T[e])&&void 0!==t&&t.withdraw?(0,h.jsx)("p",{className:"text-sm text-green-500 flex space-x-1 justify-center",children:"Ready!"}):(0,h.jsxs)("p",{className:"text-sm text-gray-300 flex space-x-1 justify-center",children:[0!==T[e].timeRemaining.h&&(0,h.jsxs)("span",{children:[T[e].timeRemaining.h,"h"]}),0!==T[e].timeRemaining.m&&(0,h.jsxs)("span",{children:[T[e].timeRemaining.m,"m"]}),0!==T[e].timeRemaining.s&&(0,h.jsxs)("span",{children:[T[e].timeRemaining.s,"s"]})]})]},e)}))})]})]})}):(0,h.jsx)(h.Fragment,{}))]})}},43790:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return t(4055)}])}},function(e){e.O(0,[774,888,179],(function(){return n=43790,e(e.s=n);var n}));var n=e.O();_N_E=n}]);